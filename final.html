<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>表白网站 - 最后一页</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        height: calc(var(--vh) * 100);
        overflow: hidden; /* 禁止滚动，防止地址栏变化 */
        touch-action: none; /* 禁止触摸滚动 */
        font-family: 'Microsoft YaHei', sans-serif;
        background: radial-gradient(circle at center, #fff0f5 0%, #ffe6f0 100%), url('bg.jpg');
        background-size: cover;
        background-position: center;
        color: #d6336c;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        position: relative;
    }
    /* 文字区域背景柔和 */
    #container {
        position: relative;
        z-index: 2;
        padding: 15px 25px;
        background: linear-gradient(
            to bottom,
            rgba(255, 255, 255, 0.15) 0%,
            rgba(255, 255, 255, 0.05) 100%
        );
        border-radius: 12px;
        backdrop-filter: blur(2px);
    }
    /* 文字样式：描边+阴影 */
    .line {
        font-size: 1.8em;
        margin: 10px 0;
        color: #d6336c;
        text-shadow: 0 2px 4px rgba(255,255,255,0.8), 0 0 6px rgba(255,105,180,0.5);
        -webkit-text-stroke: 0.5px rgba(255,255,255,0.6);
        white-space: pre-line;
    }
    /* 漂浮心形（透明背景PNG） */
    .heart {
        position: absolute;
        width: 50px;
        height: 50px;
        background: url('heart.png') no-repeat center/contain;
        filter: drop-shadow(0 0 6px rgba(255,105,180,0.8));
        opacity: 0;
        animation: driftPath 8s ease-in-out forwards;
        pointer-events: none;
        z-index: 1;
    }
    /* 不规则漂浮路径（使用translate避免vh抖动） */
    @keyframes driftPath {
        0% { transform: translate(0,0) scale(0.8); opacity: 0; }
        10% { opacity: 1; }
        25% { transform: translate(20px,-30px) rotate(10deg); }
        50% { transform: translate(-15px,-60px) rotate(-8deg); }
        75% { transform: translate(25px,-90px) rotate(6deg); }
        100% { transform: translate(-10px,-120px) scale(1); opacity: 0; }
    }
</style>
</head>
<body>
    <div id="container"></div>

    <!-- 背景音乐：Kiss the Rain -->
    <audio id="bgm" src="https://archive.org/download/Yiruma-MayBe/KissTheRain-Yiruma_3mfg2.mp3" loop></audio>

<script>
/* 修复移动端vh抖动 */
function setVh() {
    document.documentElement.style.setProperty('--vh', window.innerHeight * 0.01 + 'px');
}
setVh();
window.addEventListener('resize', setVh);

const lines = [
    "亲爱的，",
    "我可能不够完美，",
    "但我会用尽全力去爱你，",
    "陪你走过每一个日出与日落，",
    "愿意牵着你的手，直到永远 ❤️"
];

let lineIndex = 0;
let charIndex = 0;
let speed = 100;
let heartsStarted = false;

function typeLine() {
    if (lineIndex < lines.length) {
        let lineDiv = document.createElement("div");
        lineDiv.className = "line";
        document.getElementById("container").appendChild(lineDiv);

        function typeChar() {
            if (charIndex < lines[lineIndex].length) {
                lineDiv.textContent += lines[lineIndex][charIndex];
                charIndex++;
                setTimeout(typeChar, speed);
            } else {
                if (lineIndex === lines.length - 3 && !heartsStarted) {
                    heartsStarted = true;
                    startHearts();
                }
                lineIndex++;
                charIndex = 0;
                setTimeout(typeLine, 500);
            }
        }
        typeChar();
    }
}

// 生成漂浮心形（用translate避免vh抖动）
function startHearts() {
    setInterval(() => {
        let heart = document.createElement("div");
        heart.className = "heart";

        let leftPos = Math.random() * 100;
        heart.style.left = leftPos + "vw";
        heart.style.animationDuration = (6 + Math.random() * 4) + "s";

        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 10000);
    }, 500); // 降低频率减少性能压力
}

// 点击页面播放音乐（解决浏览器自动播放限制）
document.addEventListener("click", () => {
    const bgm = document.getElementById("bgm");
    bgm.play();
});

typeLine();
</script>
</body>
</html>
